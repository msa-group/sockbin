<!DOCTYPE html>
<html>

<head>
  <meta http-equiv='content-type' value='text/html;charset=utf8'>
  <title>sockbin(1): Websocket Echo Service</title>
  <style type='text/css' media='all'>
  /* style: man */
  
  body#manpage {
    margin: 0
  }
  
  .mp {
    max-width: 100ex;
    padding: 0 9ex 1ex 4ex
  }
  
  .mp p,
  .mp pre,
  .mp ul,
  .mp ol,
  .mp dl {
    margin: 0 0 20px 0
  }
  
  .mp h2 {
    margin: 10px 0 0 0
  }
  
  .mp > p,
  .mp > pre,
  .mp > ul,
  .mp > ol,
  .mp > dl {
    margin-left: 6ex
  }
  
  .mp h3 {
    margin: 0 0 0 4ex
  }
  
  .mp dt {
    margin: 0;
    clear: left
  }
  
  .mp dt.flush {
    float: left;
    width: 8ex
  }
  
  .mp dd {
    margin: 0 0 0 9ex
  }
  
  .mp h1,
  .mp h2,
  .mp h3,
  .mp h4 {
    clear: left
  }
  
  .mp pre {
    margin-bottom: 20px
  }
  
  .mp pre+h2,
  .mp pre+h3 {
    margin-top: 22px
  }
  
  .mp h2+pre,
  .mp h3+pre {
    margin-top: 5px
  }
  
  .mp img {
    display: block;
    margin: auto
  }
  
  .mp h1.man-title {
    display: none
  }
  
  .mp,
  .mp code,
  .mp pre,
  .mp tt,
  .mp kbd,
  .mp samp,
  .mp h3,
  .mp h4 {
    font-family: monospace;
    font-size: 14px;
    line-height: 1.42857142857143
  }
  
  .mp h2 {
    font-size: 16px;
    line-height: 1.25
  }
  
  .mp h1 {
    font-size: 20px;
    line-height: 2
  }
  
  .mp {
    text-align: left;
    background: #fff
  }
  
  .mp,
  .mp code,
  .mp pre,
  .mp pre code,
  .mp tt,
  .mp kbd,
  .mp samp {
    color: #131211
  }
  
  .mp h1,
  .mp h2,
  .mp h3,
  .mp h4 {
    color: #030201
  }
  
  .mp u {
    text-decoration: underline
  }
  
  .mp code,
  .mp strong,
  .mp b {
    font-weight: bold;
    color: #131211
  }
  
  .mp em,
  .mp var {
    font-style: italic;
    color: #232221;
    text-decoration: none
  }
  
  .mp a,
  .mp a:link,
  .mp a:hover,
  .mp a code,
  .mp a pre,
  .mp a tt,
  .mp a kbd,
  .mp a samp {
    color: #0000ff
  }
  
  .mp b.man-ref {
    font-weight: normal;
    color: #434241
  }
  
  .mp pre {
    padding: 0 4ex
  }
  
  .mp pre code {
    font-weight: normal;
    color: #434241
  }
  
  .mp h2+pre,
  h3+pre {
    padding-left: 0
  }
  
  ol.man-decor,
  ol.man-decor li {
    margin: 3px 0 10px 0;
    padding: 0;
    float: left;
    width: 33%;
    list-style-type: none;
    text-transform: uppercase;
    color: #999;
    letter-spacing: 1px
  }
  
  ol.man-decor {
    width: 100%
  }
  
  ol.man-decor li.tl {
    text-align: left
  }
  
  ol.man-decor li.tc {
    text-align: center;
    letter-spacing: 4px
  }
  
  ol.man-decor li.tr {
    text-align: right;
    float: right
  }

  </style>
  <style type='text/css' media='all'>
  /* style: 80c */
  
  .mp {
    max-width: 89ex
  }
  
  ul {
    list-style: None;
    margin-left: 0!important
  }
  
  .man-navigation {
    left: 101ex
  }
  .fork-me {
    z-index:2;
    position: absolute; top: 0; right: 0; border: 0;
  }
  #output-window{
    z-index:1;
    display: block;
    position: fixed;
    right: 15px;
    left: 600px;
    top: 15px;
    bottom: 0px;
  }
  #output-window code{
    display: block;
    position:absolute;
    top:0px;
    bottom:80px;
    width: 100%;
    padding: 9.5px;
    margin: 0 0 10px;
    font-size: 13px;
    line-height: 1.42857143;
    color: hsl(0, 0%, 20%);
    word-break: break-all;
    word-wrap: break-word;
    background-image: url('http://i.imgur.com/P8JZunC.png');
    background-repeat:no-repeat;
    background-position:center center;
    background-color: hsl(0, 0%, 96%);
    border: 1px solid hsl(0, 0%, 80%);
    border-radius: 4px;
    box-sizing: border-box;
    overflow-y:auto;
  }
  #output-window .button-bar {
    display:block;
    width:100%;
    position:absolute;
    bottom:15px;
  }
  #output-window .button-bar input {
    width:100%;
    height:30px;
    border: 1px solid hsl(0, 0%, 80%);
    border-radius: 4px;
    box-sizing: border-box;
    margin-bottom:10px;
  }
  #output-window .button-bar button{
    display:block;
    float:left;
    margin:0 5px 10px;
  }
  * {
    font-family: monospace;
  }
  </style>
</head>

<body id='manpage'>
  <a class="fork-me" href="http://github.com/therebelrobot/sockbin"><img src="https://s3.amazonaws.com/github/ribbons/forkme_right_darkblue_121621.png" alt="Fork me on GitHub"></a>
  <div class='mp'>
    <h1>sockbin(1): Websocket Echo Service</h1>
    <p>Build with &lt;3 by <a href="https://therebelrobot.com/">therebelrobot</a> using <a href="https://nodejs.org">Node.js</a></p>
    <h2 id="HOST">HOSTNAME</h2>
    <ul>
      <li><code>ws://sockb.in</code></li>
    </ul>
    <h2 id="ENDPOINTS">ENDPOINTS</h2>
    <ul>
      <li><a href="#" class="endpoint" data-endpoint="/"><code>/</code></a> Basic echo.</li>
      <li><a href="#" class="endpoint" data-endpoint="/?response=%7Bfoo%3A%20bar%7D"><code>/?response=%7Bfoo%3A%20bar%7D</code></a> Custom Response.</li>
      <li><a href="#" class="endpoint" data-endpoint="/?pipe=http%3A%2F%2Fhttpbin.org%2Fget"><code>/?pipe=http%3A%2F%2Fhttpbin.org%2Fget</code></a> Fetch an external url.</li>
      <li><a href="#" class="endpoint" data-endpoint="/delay/1000"><code>/delay/:n</code></a> Return response after <em>n</em> millisecond delay.</li>
      <li><a href="#" class="endpoint" data-endpoint="/repeat/5"><code>/repeat/:n</code></a> Return response <em>n</em> times.</li>
      <li><a href="#" class="endpoint" data-endpoint="/runfor/60000/delay/5000"><code>/runfor/:n/delay/:n</code></a> Return response with <em>n</em> ms delay for <em>n</em> ms.</li>
      <li><a href="#" class="endpoint" data-endpoint="/repeat/5/delay/5000"><code>/repeat/:n/delay/:n</code></a> Functions can be chained.</li>
    </ul>
    <h2 id="DESCRIPTION">DESCRIPTION</h2>
    <p>Testing a websocket library can become difficult sometimes. <a href="http://httpbin.org">HTTPbin</a> is fantastic for testing normal HTTP requests, but doesn't provide endpoints for websockets. This exists to cover that need. Currently only supports raw websocket requests, however support for additional websocket libraries are being worked on (Socket.io, etc).</p>
    <p><em>Note: Due to hosting restrictions, repeat, delay, and runfor have default values (&lt;50, &gt;5000, &lt;350000, respectively). To override these values, please install sockbin locally and use the <code>override</code> method. See below for details.</em></p>
    <p><em>Examples on this page are using <a href="https://github.com/therebelrobot/soxx">soxx</a>, a simple websocket microlib.</em></p>
    <h2 id="Installing-and-running-from-PyPI">Installing and running locally</h2>
    <p>You can install sockbin locally and override the hosting service restrictions by <a href="http://github.com/therebelrobot/sockbin">cloning the repo</a> and setting an <code>OVERRIDE</code> environment variable.</p>
    <pre><code class="bash">$ git clone https://github.com/therebelrobot/sockbin.git
$ cd sockbin
$ npm install
$ OVERRIDE=token npm start
</code></pre>
    <p>When you then add <code>&override=token</code> to your request endpoint, you can spam your server as much as you like.</p>
    <p>I'm currently working on getting a cli published to NPM (it's on there, but no interface atm). Check back soon for that.</p>
    <h2 id="Changelog">Changelog</h2>
    <ul>
      <li>0.1.3: Updated client-facing page, integrated soxx</li>
      <li>0.1.2: Added docs and reserved NPM name</li>
      <li>0.1.1: Added initial files</li>
    </ul>
    <h2 id="AUTHOR">AUTHOR</h2>
    <p>Originally created by <a href="http://therebelrobot.com/">Trent Oswald (@therebelrobot)</a>.</p>
    <h2 id="SEE-ALSO">SEE ALSO</h2>
    <p><a href="http://mockbin.com">mockbin</a> - Custom HTTP Request &amp; Response Endpoints.</p>
    <p><a href="https://www.httpbin.org">httpbin</a> - HTTP Request &amp; Response Service.</p>
    <p><a href="http://www.getpostman.com/">Postman</a> - Make HTTP requests and inspect responses.</p>
    <p><a href="https://www.hurl.it">Hurl.it</a> - Make HTTP requests.</p>
    <p><a href="http://requestb.in">RequestBin</a> - Inspect HTTP requests.</p>
  </div>
  <div id="output-window">
    <code id="output">
      Output:

    </code>
    <div class="button-bar">
      <input class="message" type="text" value="Hello Sockbin!" />
      <button class="connect">Connect</button>
      <button class="send">Send Message</button>
      <button class="kill">Disconnect</button>
    </div>
  </div>
  <script type="text/javascript" src="https://cdn.rawgit.com/therebelrobot/soxx/f755395a744a248baf20228f443f7d6f6b77b946/dist/soxx.js"></script>
  <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.0.0-beta1/jquery.min.js"></script>
  <script type="text/javascript">
$(document).ready(function () {
  $(document).on('click', '.endpoint', function (event) {
    console.log(this, event)
    var $thisLink = $(event.target).closest('a')
    var $output = $('#output')
    var $connect = $('button.connect')
    var $send = $('button.send')
    var $kill = $('button.kill')
    var $message = $('input.message')

    var path = $thisLink.attr('data-endpoint')
    var wsUri = 'ws://' + window.location.host + path
    var writeToOutput = function writeToOutput (message) {
      var pre = document.createElement('p')
      pre.style.wordWrap = 'break-word'
      pre.innerHTML = message
      $output.append(pre)
      $output[0].scrollTop = $output[0].scrollHeight;
    }
    var onOpen = function onOpen (evt) {
      writeToOutput('<span style="color: green;">CONNECTED to ' + path + '</span>')
      $send.attr('disabled', false)
      $kill.attr('disabled', false)
      $connect.attr('disabled', true)
    }

    var onRetry = function onRetry (evt) {
      writeToOutput('Retrying connection to ' + path)
      $('#' + elements.send).attr('disabled', false)
    }
    var onClose = function onClose (evt) {
      writeToOutput('<span style="color: orange;">DISCONNECTED from ' + path + '</span>')
      $send.attr('disabled', true)
      $kill.attr('disabled', true)
      $connect.attr('disabled', false)
      window.websocket = false
    }

    var onMessage = function onMessage (evt) {
      writeToOutput('<span style="color: blue;">RESPONSE: ' + evt.data + '</span>')
    }

    var onError = function onError (evt) {
      writeToOutput('<span style="color: red;">RESPONSE: ' + evt.data + '</span>')
    }

    var doSend = function doSend (message) {
      writeToOutput('SENT: ' + message)
      window.websocket.write(message)
    }
    var connect = function connect () {
      $send.attr('disabled', true)
      $kill.attr('disabled', true)
      $connect.attr('disabled', true)
      window.websocket = new Soxx({
        url: wsUri,
        onOpen: onOpen,
        onClose: onClose,
        onRetry: onRetry,
        onMessage: onMessage,
        onError: onError
      })
      writeToOutput('CONNECTING to ' + path + ' ...')
      window.websocket.connect()
    }
    $send.attr('disabled', true)
    $kill.attr('disabled', true)
    $connect.attr('disabled', true)
    if (window.websocket) {
      var thisPath = window.websocket._settings.url
      thisPath = thisPath.split('ws://' + window.location.host)[1]
      window.websocket._settings.onClose = function () {
        writeToOutput('<span style="color: orange;">DISCONNECTED from ' + thisPath + '</span>')
        connect()
      }
      writeToOutput('DISCONNECTING from ' + thisPath + ' ...')
      window.websocket.disconnect()
    } else {
      connect()
    }
    $connect.off('click').on('click', connect)
    $send.off('click').on('click', function () {
      var message = $message.val()
      doSend(message)
    })
    $kill.off('click').on('click', function () {
      writeToOutput('DISCONNECTING from ' + path + ' ...')
      window.websocket.disconnect()
    })
  })
})

  </script>
</body>

</html>

